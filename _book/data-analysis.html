<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Berland-Wildhay Watershed Connectivity Remediation Planning - 7&nbsp; Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./data-loading.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Analysis</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Berland-Wildhay Watershed Connectivity Remediation Planning</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Data Compilation and Spatial Analysis Report</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Model Purpose and Approach</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Purpose</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-overview.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Approach</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Software Documentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software-docs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">License</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-sources.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data sources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./requirements-config.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Requirements and Configuration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-loading.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading and Preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-analysis.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#individual-tools" id="toc-individual-tools" class="nav-link active" data-scroll-target="#individual-tools"> <span class="header-section-number">7.1</span> Individual Tools</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>The data analysis tools are also called by the main processing script: <code>process_watershed.py</code>.</p>
<section id="individual-tools" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="individual-tools"><span class="header-section-number">7.1</span> Individual Tools</h2>
<section id="compute-upstream-and-downstream-barrier-and-fish-species-information" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="compute-upstream-and-downstream-barrier-and-fish-species-information">1. Compute upstream and downstream barrier and fish species information</h4>
<p><strong>Tool: <a href="https://github.com/egouge/cwf-alberta/blob/main/src/processing_scripts/compute_updown_barriers_fish.py">compute_updown_barriers_fish.py</a></strong></p>
<p>This script computes a number of statistics for each stream segment:</p>
<ul>
<li>Number of upstream and downstream barriers</li>
<li>The identifiers of the upstream and downstream barriers</li>
<li>The fish species stocked on the stream segment</li>
<li>The fish species which are stocked upstream and downstream of the stream segment</li>
<li>The fish species surveyed on the stream segment</li>
<li>The fish species which were surveyed upstream and downstream of the stream segment</li>
</ul>
<section id="input-requirements" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="input-requirements">Input Requirements:</h5>
<ul>
<li>Fish observation data</li>
<li>Stream network</li>
<li>Barriers table</li>
</ul>
</section>
<section id="output" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="output">Output:</h5>
<ul>
<li>Addition of statistic fields to the stream network table</li>
</ul>
</section>
</section>
<section id="compute-accessibility-models" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="compute-accessibility-models">2. Compute Accessibility Models</h4>
<p><strong>Tool: <a href="https://github.com/egouge/cwf-alberta/blob/main/src/processing_scripts/compute_gradient_accessibility.py">compute_gradient_accessibility.py</a></strong></p>
<p>This script computes an accessibility value for each fish species for each stream segment based on:</p>
<ul>
<li>Computed gradient barriers</li>
<li>Maximum accessibility gradient (specified in the <code>fish_species</code> table)</li>
<li>Barrier location</li>
<li>Fish survey and stocking information</li>
</ul>
<p>Barriers include:</p>
<ul>
<li>CABD loaded barriers (dams, waterfalls)</li>
<li>Modelled crossing on stream with Strahler order &lt; 6</li>
</ul>
<p>Stream segments will be classified as:</p>
<ul>
<li><code>ACCESSIBLE</code> = all downstream gradients are less than the maximum gradient threshold for the given species and there are no barriers downstream (OR there are fish stocking or survey points upstream for the given species)</li>
<li><code>POTENTIAL ACCESSIBLE</code> = all downstream gradients are less than the maximum gradient threshold for the given species, but there is a barrier downstream</li>
<li><code>NOT ACCESSIBLE</code> = any downstream gradient is great than the maximum gradient threshold for the given species</li>
</ul>
<section id="input-requirements-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="input-requirements-1">Input Requirements:</h5>
<ul>
<li>Stream network</li>
<li>Barriers Table</li>
</ul>
</section>
<section id="output-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="output-1">Output:</h5>
<ul>
<li>Addition of an accessibility field for each fish species to the stream network table</li>
</ul>
</section>
</section>
<section id="compute-habitat-models" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="compute-habitat-models">3. Compute Habitat Models</h4>
<p><strong>Tool: <a href="https://github.com/egouge/cwf-alberta/blob/main/src/processing_scripts/compute_habitat_models.py">compute_habitat_models.py</a></strong></p>
<p>This script computes a <code>true</code>/<code>false</code> value for the following habitat models for each stream segment, based on the following parameters and criteria:</p>
<ol type="1">
<li>Stream gradient</li>
</ol>
<pre><code>WHERE stream_gradient stream_gradient ≥ min_gradient AND
stream_gradient &lt; max_gradient AND
species_accessibility IN (ACCESSIBLE OR POTENTIALLY ACCESSIBLE)</code></pre>
<ol start="2" type="1">
<li>Discharge (m^3/s)</li>
</ol>
<pre><code>WHERE stream_discharge ≥ min_discharge AND
stream_discharge &lt; max_discharge AND
species_accessibility IN (ACCESSIBLE OR POTENTIALLY ACCESSIBLE)</code></pre>
<ol start="3" type="1">
<li>Channel confinement (ratio of valley width/channel width)</li>
</ol>
<pre><code>Always `true` for now, model to be defined later.</code></pre>
<section id="input-requirements-2" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="input-requirements-2">Input Requirements:</h5>
<ul>
<li>Stream network</li>
</ul>
</section>
<section id="output-2" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="output-2">Output:</h5>
<ul>
<li>Addition of habitat model fields for each species to stream network table</li>
</ul>
</section>
</section>
<section id="compute-barrier-statistics" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="compute-barrier-statistics">4. Compute Barrier Statistics</h4>
<p><strong>Tool: <a href="https://github.com/egouge/cwf-alberta/blob/main/src/processing_scripts/compute_modelled_crossings_upstream_values.py">compute_modelled_crossings_upstream_values.py</a></strong></p>
<p>This script computes a collection of modelled crossing statistics for each species and habitat model, including:</p>
<ul>
<li>Total accessible upstream length: total length of streams that are accessible upstream of this point</li>
<li>Total upstream habitat length: total upstream length with habitat model = <code>true</code></li>
<li>Functional upstream habitat length: computed by walking up the stream network summing up length of stream segments with habitat model = <code>true</code>, stopping at the first barrier encountered on the mainstem and all potential tributaries (upstream)</li>
</ul>
<section id="input-requirements-3" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="input-requirements-3">Input Requirements:</h5>
<ul>
<li>Stream network</li>
<li>Modelled crossing</li>
<li>Barriers</li>
</ul>
</section>
<section id="output-3" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="output-3">Output:</h5>
<ul>
<li>Addition of statistics fields to the modelled crossings table</li>
</ul>
</section>
</section>
<section id="match-barrier-inspection-data" class="level4" data-number="7.1.0.1">
<h4 data-number="7.1.0.1" class="anchored" data-anchor-id="match-barrier-inspection-data"><span class="header-section-number">7.1.0.1</span> Match Barrier Inspection Data</h4>
<p>AEP’s Watercourse Crossing Program maintains an inventory of inspections that have been performed by barrier owners under the program. We are currently negotiating a data-sharing agreement that would allow this data to be shared publicly, with some sensitive attributes witheld (e.g., specific ownership).</p>
<p>Barrier inspection points will be matched to corresponding modelled stream crossings using a 150 m distance threshold (i.e., inspections points and modelled points within 150 m of each other will be matched). Unmatched inspection points will be manually review and matched, if possible.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data-loading.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading and Preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>